<#setting url_escaping_charset='UTF-8'>
PREFIX v:       <http://www.w3.org/2006/vcard/ns#>
PREFIX xsd:     <http://www.w3.org/2001/XMLSchema#>
PREFIX foaf:    <http://xmlns.com/foaf/0.1/>
PREFIX bibo: <http://purl.org/ontology/bibo/>
PREFIX dbpedia-owl: <http://dbpedia.org/ontology/>
PREFIX dc: <http://purl.org/dc/elements/1.1/>
PREFIX dct: <http://purl.org/dc/terms/>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX locn: <http://www.w3.org/ns/locn#>
PREFIX milieu: <http://id.milieuinfo.be/def#>
PREFIX org: <http://www.w3.org/ns/org#>
PREFIX os: <http://open-services.net/ns/asset#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX prov: <http://www.w3.org/ns/prov#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX rov: <http://www.w3.org/ns/regorg#>
PREFIX schema: <http://schema.org/>
PREFIX dcat: <http://www.w3.org/ns/dcat#>
PREFIX fabio: <http://purl.org/spar/fabio/>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX openorg: <http://purl.org/openorg/organization>
PREFIX sdmx-dimension: <http://purl.org/linked-data/sdmx/2009/dimension#>

CONSTRUCT {
	<http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> ?vp ?v.
	<http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> ?op ?o.

	<http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> ?bnp ?bn.
	?bn ?bnl2p ?bnl2o.

	?bnl2o ?bnl3p ?bnl3o.

	?vp rdfs:label ?vplbl.
	?vp skos:prefLabel ?vpslbl.

	?op rdfs:label ?oplbl.
	?op skos:prefLabel ?opslbl.

	?o rdfs:label ?olbl.
	?o skos:prefLabel ?oslbl.

	?bnp rdfs:label ?bnplbl.
	?bnp skos:prefLabel ?bnpslbl.
	
	?bnl2p rdfs:label ?bnplbl2.
	?bnl2p skos:prefLabel ?bnpslbl2.

	?bnl2o rdfs:label ?ol3lbl.
	?bnl2o skos:prefLabel ?osl3lbl.

	?s ?ip <http://id.milieuinfo.be/${owner}/${id}/${remainder}#id>.
	
	?s rdfs:label ?ilbl.
	?s skos:prefLabel ?islbl.
	?ip rdfs:label ?iplbl.
	?ip skos:prefLabel ?ipslbl.

	<http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> rdfs:isDefinedBy <http://id.milieuinfo.be/${owner}/${id}/${remainder}.nt> .
	<http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> rdfs:isDefinedBy <http://id.milieuinfo.be/${owner}/${id}/${remainder}.rdf> .
	<http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> rdfs:isDefinedBy <http://id.milieuinfo.be/${owner}/${id}/${remainder}.ttl> .
	<http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> rdfs:isDefinedBy <http://id.milieuinfo.be/${owner}/${id}/${remainder}.jsonld> .
	<http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> foaf:page <http://id.milieuinfo.be/${owner}/${id}/${remainder}.html> .
	}
WHERE { 
 {graph ?g
	 {<http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> ?vp ?v.
	  FILTER (isLiteral(?v))
	  <http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> ?op ?o.
	  FILTER (isURI(?o))
	  OPTIONAL 
		  {
		  <http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> ?bnp ?bn.
		  FILTER (isBlank(?bn))
		  }
	  OPTIONAL 
		  {
		  <http://id.milieuinfo.be/${owner}/${id}/${remainder}#id> ?bnp ?bn.
		 	?bn ?bnl2p ?bnl2o.
		  }
	  OPTIONAL {?bnl2o ?bnl3p ?bnl3o.}

	  OPTIONAL {graph ?g01v{?vp rdfs:label ?vplbl.}}
	  OPTIONAL {graph ?g02v{?vp skos:prefLabel ?vpslbl.}}

	  OPTIONAL {graph ?g01o{?op rdfs:label ?oplbl.}}
	  OPTIONAL {graph ?g02o{?op skos:prefLabel ?opslbl.}}

	  OPTIONAL {graph ?g03o{?o rdfs:label ?olbl.}}
	  OPTIONAL {graph ?g04o{?o skos:prefLabel ?oslbl.}}

	  OPTIONAL {graph ?g01b{?bnp rdfs:label ?bnplbl.}}
	  OPTIONAL {graph ?g02b{?bnp skos:prefLabel ?bnpslbl.}}

	  OPTIONAL {graph ?g01b2{?bnl2p rdfs:label ?bnplbl2.}}
	  OPTIONAL {graph ?g02b2{?bnl2p skos:prefLabel ?bnpslbl2.}}

	  OPTIONAL {graph ?g07{?bnl2o rdfs:label ?ol3lbl.}}
	  OPTIONAL {graph ?g08{?bnl2o skos:prefLabel ?osl3lbl.}}
	 }
 }
 UNION
	{graph ?g
		{?s ?ip <http://id.milieuinfo.be/${owner}/${id}/${remainder}#id>.
		OPTIONAL {?s rdfs:label ?ilbl.}
		OPTIONAL {?s skos:prefLabel ?islbl.}
		OPTIONAL {graph ?g20{?ip rdfs:label ?iplbl.}}
		OPTIONAL {graph ?g21{?ip skos:prefLabel ?ipslbl.}}
		}
	}
}
